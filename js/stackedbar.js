    // Sample data (replace this with your data)
    //var data = [{"time_diff": 0, "class": "Class A", "count": 611}, {"time_diff": 0, "class": "Class B", "count": 978}, {"time_diff": 0, "class": "Class C", "count": 6}, {"time_diff": 1, "class": "Class A", "count": 125}, {"time_diff": 1, "class": "Class B", "count": 155}, {"time_diff": 1, "class": "Class C", "count": 1}, {"time_diff": 2, "class": "Class A", "count": 64}, {"time_diff": 2, "class": "Class B", "count": 84}, {"time_diff": 2, "class": "Class C", "count": 0}, {"time_diff": 3, "class": "Class A", "count": 42}, {"time_diff": 3, "class": "Class B", "count": 40}, {"time_diff": 3, "class": "Class C", "count": 0}, {"time_diff": 4, "class": "Class A", "count": 39}, {"time_diff": 4, "class": "Class B", "count": 32}, {"time_diff": 4, "class": "Class C", "count": 0}, {"time_diff": 5, "class": "Class A", "count": 23}, {"time_diff": 5, "class": "Class B", "count": 16}, {"time_diff": 5, "class": "Class C", "count": 1}, {"time_diff": 6, "class": "Class A", "count": 31}, {"time_diff": 6, "class": "Class B", "count": 15}, {"time_diff": 6, "class": "Class C", "count": 0}, {"time_diff": 7, "class": "Class A", "count": 19}, {"time_diff": 7, "class": "Class B", "count": 19}, {"time_diff": 7, "class": "Class C", "count": 0}, {"time_diff": 8, "class": "Class A", "count": 14}, {"time_diff": 8, "class": "Class B", "count": 19}, {"time_diff": 8, "class": "Class C", "count": 0}, {"time_diff": 9, "class": "Class A", "count": 14}, {"time_diff": 9, "class": "Class B", "count": 12}, {"time_diff": 9, "class": "Class C", "count": 0}, {"time_diff": 10, "class": "Class A", "count": 18}, {"time_diff": 10, "class": "Class B", "count": 10}, {"time_diff": 10, "class": "Class C", "count": 0}, {"time_diff": 11, "class": "Class A", "count": 8}, {"time_diff": 11, "class": "Class B", "count": 18}, {"time_diff": 11, "class": "Class C", "count": 0}, {"time_diff": 12, "class": "Class A", "count": 12}, {"time_diff": 12, "class": "Class B", "count": 11}, {"time_diff": 12, "class": "Class C", "count": 0}, {"time_diff": 13, "class": "Class A", "count": 11}, {"time_diff": 13, "class": "Class B", "count": 9}, {"time_diff": 13, "class": "Class C", "count": 1}, {"time_diff": 14, "class": "Class A", "count": 15}, {"time_diff": 14, "class": "Class B", "count": 11}, {"time_diff": 14, "class": "Class C", "count": 0}, {"time_diff": 15, "class": "Class A", "count": 8}, {"time_diff": 15, "class": "Class B", "count": 7}, {"time_diff": 15, "class": "Class C", "count": 1}, {"time_diff": 16, "class": "Class A", "count": 10}, {"time_diff": 16, "class": "Class B", "count": 7}, {"time_diff": 16, "class": "Class C", "count": 0}, {"time_diff": 17, "class": "Class A", "count": 20}, {"time_diff": 17, "class": "Class B", "count": 8}, {"time_diff": 17, "class": "Class C", "count": 0}, {"time_diff": 18, "class": "Class A", "count": 21}, {"time_diff": 18, "class": "Class B", "count": 8}, {"time_diff": 18, "class": "Class C", "count": 0}, {"time_diff": 19, "class": "Class A", "count": 9}, {"time_diff": 19, "class": "Class B", "count": 14}, {"time_diff": 19, "class": "Class C", "count": 0}, {"time_diff": 20, "class": "Class A", "count": 19}, {"time_diff": 20, "class": "Class B", "count": 10}, {"time_diff": 20, "class": "Class C", "count": 0}, {"time_diff": 21, "class": "Class A", "count": 17}, {"time_diff": 21, "class": "Class B", "count": 8}, {"time_diff": 21, "class": "Class C", "count": 0}, {"time_diff": 22, "class": "Class A", "count": 11}, {"time_diff": 22, "class": "Class B", "count": 9}, {"time_diff": 22, "class": "Class C", "count": 0}, {"time_diff": 23, "class": "Class A", "count": 10}, {"time_diff": 23, "class": "Class B", "count": 7}, {"time_diff": 23, "class": "Class C", "count": 0}, {"time_diff": 24, "class": "Class A", "count": 16}, {"time_diff": 24, "class": "Class B", "count": 10}, {"time_diff": 24, "class": "Class C", "count": 0}, {"time_diff": 25, "class": "Class A", "count": 25}, {"time_diff": 25, "class": "Class B", "count": 9}, {"time_diff": 25, "class": "Class C", "count": 1}, {"time_diff": 26, "class": "Class A", "count": 18}, {"time_diff": 26, "class": "Class B", "count": 7}, {"time_diff": 26, "class": "Class C", "count": 0}, {"time_diff": 27, "class": "Class A", "count": 6}, {"time_diff": 27, "class": "Class B", "count": 6}, {"time_diff": 27, "class": "Class C", "count": 0}, {"time_diff": 28, "class": "Class A", "count": 12}, {"time_diff": 28, "class": "Class B", "count": 6}, {"time_diff": 28, "class": "Class C", "count": 0}, {"time_diff": 29, "class": "Class A", "count": 7}, {"time_diff": 29, "class": "Class B", "count": 12}, {"time_diff": 29, "class": "Class C", "count": 0}, {"time_diff": 30, "class": "Class A", "count": 11}, {"time_diff": 30, "class": "Class B", "count": 11}, {"time_diff": 30, "class": "Class C", "count": 0}, {"time_diff": 31, "class": "Class A", "count": 8}, {"time_diff": 31, "class": "Class B", "count": 8}, {"time_diff": 31, "class": "Class C", "count": 0}, {"time_diff": 32, "class": "Class A", "count": 6}, {"time_diff": 32, "class": "Class B", "count": 1}, {"time_diff": 32, "class": "Class C", "count": 0}, {"time_diff": 33, "class": "Class A", "count": 7}, {"time_diff": 33, "class": "Class B", "count": 4}, {"time_diff": 33, "class": "Class C", "count": 0}, {"time_diff": 34, "class": "Class A", "count": 9}, {"time_diff": 34, "class": "Class B", "count": 3}, {"time_diff": 34, "class": "Class C", "count": 0}, {"time_diff": 35, "class": "Class A", "count": 7}, {"time_diff": 35, "class": "Class B", "count": 4}, {"time_diff": 35, "class": "Class C", "count": 0}, {"time_diff": 36, "class": "Class A", "count": 6}, {"time_diff": 36, "class": "Class B", "count": 1}, {"time_diff": 36, "class": "Class C", "count": 0}, {"time_diff": 37, "class": "Class A", "count": 3}, {"time_diff": 37, "class": "Class B", "count": 3}, {"time_diff": 37, "class": "Class C", "count": 0}, {"time_diff": 38, "class": "Class A", "count": 3}, {"time_diff": 38, "class": "Class B", "count": 4}, {"time_diff": 38, "class": "Class C", "count": 0}, {"time_diff": 39, "class": "Class A", "count": 3}, {"time_diff": 39, "class": "Class B", "count": 2}, {"time_diff": 39, "class": "Class C", "count": 0}, {"time_diff": 40, "class": "Class A", "count": 5}, {"time_diff": 40, "class": "Class B", "count": 3}, {"time_diff": 40, "class": "Class C", "count": 0}, {"time_diff": 41, "class": "Class A", "count": 8}, {"time_diff": 41, "class": "Class B", "count": 4}, {"time_diff": 41, "class": "Class C", "count": 0}, {"time_diff": 42, "class": "Class A", "count": 1}, {"time_diff": 42, "class": "Class B", "count": 1}, {"time_diff": 42, "class": "Class C", "count": 0}, {"time_diff": 43, "class": "Class A", "count": 1}, {"time_diff": 43, "class": "Class B", "count": 1}, {"time_diff": 43, "class": "Class C", "count": 0}, {"time_diff": 44, "class": "Class A", "count": 2}, {"time_diff": 44, "class": "Class B", "count": 2}, {"time_diff": 44, "class": "Class C", "count": 0}, {"time_diff": 46, "class": "Class A", "count": 0}, {"time_diff": 46, "class": "Class B", "count": 4}, {"time_diff": 46, "class": "Class C", "count": 0}, {"time_diff": 47, "class": "Class A", "count": 2}, {"time_diff": 47, "class": "Class B", "count": 0}, {"time_diff": 47, "class": "Class C", "count": 0}, {"time_diff": 48, "class": "Class A", "count": 0}, {"time_diff": 48, "class": "Class B", "count": 2}, {"time_diff": 48, "class": "Class C", "count": 0}, {"time_diff": 51, "class": "Class A", "count": 1}, {"time_diff": 51, "class": "Class B", "count": 0}, {"time_diff": 51, "class": "Class C", "count": 0}, {"time_diff": 57, "class": "Class A", "count": 0}, {"time_diff": 57, "class": "Class B", "count": 1}, {"time_diff": 57, "class": "Class C", "count": 0}, {"time_diff": 61, "class": "Class A", "count": 1}, {"time_diff": 61, "class": "Class B", "count": 0}, {"time_diff": 61, "class": "Class C", "count": 0}, {"time_diff": 62, "class": "Class A", "count": 0}, {"time_diff": 62, "class": "Class B", "count": 1}, {"time_diff": 62, "class": "Class C", "count": 0}, {"time_diff": 69, "class": "Class A", "count": 1}, {"time_diff": 69, "class": "Class B", "count": 0}, {"time_diff": 69, "class": "Class C", "count": 0}, {"time_diff": 77, "class": "Class A", "count": 0}, {"time_diff": 77, "class": "Class B", "count": 2}, {"time_diff": 77, "class": "Class C", "count": 0}, {"time_diff": 85, "class": "Class A", "count": 1}, {"time_diff": 85, "class": "Class B", "count": 0}, {"time_diff": 85, "class": "Class C", "count": 0}];
    var legend_data = ["Class A", "Class B", "Class"];

    //var data = await FileAttachment("/Users/juliabeck/Documents/USC/DSCI550/Assignment2/Assignment3/dsci551hw3/data/stackedbar.json").json();

    //var â‰ˆ;

    var data = d3.json("../data/stackedbar.json")
      .then(function(data) {
        console.log('HELLO');
        console.log(data);
        // Data loaded successfully
        //data = jsonData;
        //console.log(data);
           // Define dimensions for the chart
        var margin = { top: 10, right: 10, bottom: 20, left: 40 };
        var width = 928;
        var height = 500;

        // Create SVG element
        var svg = d3.select('#visualization')
            .append("svg")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height)
            .attr("viewBox", [0, 0, width, height])
            .attr("style", "max-width: 100%; height: auto;");
            //.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

        // Stack data
        var series = d3.stack()
            .keys(d3.union(data.map(d => d.class)))
            .value(([, D], key) => D.get(key).count)
            (d3.index(data, d => d.time_diff, d => d.class)); //creates a graph where everything is a single bar

        // Create scales
        var x = d3.scaleBand()
            .domain(d3.groupSort(data, D => -(D, d => d.time_diff), d => d.time_diff))
            .range([margin.left,width-margin.right])
            .padding(0.1);

        var y = d3.scaleLinear()
            .domain([0, d3.max(series, d => d3.max(d, d => d[1]))])
            .range([height-margin.bottom, margin.top]);

        const color = d3.scaleOrdinal()
          .domain(series.map(d => d.key))
          .range(d3.schemeSpectral[series.length])
          .unknown("#ccc");

           // A function to format the value in the tooltip.
        const formatValue = x => isNaN(x) ? "N/A" : x.toLocaleString("en")

        svg.append("g")
            .selectAll()
            .data(series)
          .join("g")
              .attr("fill", d => color(d.key))
            .selectAll("rect")
            .data(D => D.map(d => (d.key = D.key, d)))
            .join("rect")
              .attr("x", d => x(d.data[0]))
              .attr("y", d => y(d[1]))
              .attr("height", d => y(d[0]) - y(d[1]))
              .attr("width", x.bandwidth())
            .append("title")
              .text(d => `${d.data[0]} ${d.key}\n${formatValue(d.data[1].get(d.key).count)}`)

        // Add axes
        svg.append("g")
            .attr("transform", `translate(0,${height - margin.bottom})`)
              .call(d3.axisBottom(x).tickSizeOuter(0))
              .call(g => g.selectAll(".domain").remove());

        svg.append("g")
            .attr("transform", `translate(${margin.left},0)`)
          .call(d3.axisLeft(y).ticks(null, "s"))
          .call(g => g.selectAll(".domain").remove());


        //adding legend
        var colors = d3.scaleOrdinal()
            .domain(legend_data)
            .range(d3.schemeSpectral[series.length]); // Example colors

        // Create legend SVG element
        var legend = d3.select("#visualization").append("svg")
            .attr("class", "legend")
            .attr("width", 200)
            .attr("height", 100);

        // Create legend entries
        var legendEntries = legend.selectAll(".legend-entry")
            .data(legend_data)
            .enter().append("g")
            .attr("class", "legend-entry")
            .attr("transform", function(d, i) {
                return "translate(0," + (i * 20) + ")";
            });

        legendEntries.append("rect")
            .attr("x", 10)
            .attr("width", 18)
            .attr("height", 18)
            .style("fill", colors);

        legendEntries.append("text")
            .attr("x", 40)
            .attr("y", 9)
            .attr("dy", ".35em")
            .text(function(d) { return d; });

        // Position legend
        var legendWidth = legend.node().getBBox().width;

      })
      .catch(function(error) {
        // Error handling if the data fails to load
        console.error("Error loading data:", error);
      });

    
    

 